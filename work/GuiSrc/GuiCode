import tkinter as tk
from tkinter import filedialog
from PIL import ImageTk, Image
import numpy as np
import cv2

# import the Haarcascade classifier
face_cascade = cv2.CascadeClassifier("work\stop_data.xml")

# initialize the GUI
root = tk.Tk()
root.title("Sign Detection")
root.geometry("500x500")
root.minsize(width=300, height=300)
# function to open an image file and display it on the GUI
def open_image():
    file_path = filedialog.askopenfilename()
    image = cv2.imread(file_path)
    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)
    image = Image.fromarray(image)
    image = ImageTk.PhotoImage(image)
    image_label.config(image=image)
    image_label.image = image
    detect_signs(file_path)
    
# function to detect the signs in the image
def detect_signs(file_path):
    image = cv2.imread(file_path)
    gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
    signs = face_cascade.detectMultiScale(gray, scaleFactor=1.1, minNeighbors=5)
    for (x,y,w,h) in signs:
        cv2.rectangle(image,(x,y),(x+w,y+h),(255,0,0),2)
    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)
    image = Image.fromarray(image)
    image = ImageTk.PhotoImage(image)
    image_label.config(image=image)
    image_label.image = image
    
# button to open an image file
open_button = tk.Button(root, text="Open Image", command=open_image)
open_button.pack()

# label to display the selected image
image_label = tk.Label(root)
image_label.pack()

root.mainloop()
